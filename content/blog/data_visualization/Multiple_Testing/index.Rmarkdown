---
title: "Multiple Testing"
excerpt: "summary"
date: 2022-05-20
author: "Federica Gazzelloni"
draft: false
images:
series:
tags:
categories:
layout: single
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,eval=FALSE,comment = "")
```


## Overview

*Multiple testing* a mistery explained.

Sometimes answering a research question means evaluation of different combination of predictors, and this is the case when multiple hypothesis testing is made.

The following are the fundamental steps for understanding how to procede when a multiple hypothesis testing is needed.


The picture 

![](featured.png)



```{r lib1, ,eval=TRUE,message=FALSE, warning=FALSE, paged.print=FALSE}
library(tidyverse)
```

# Research questions

In general, hypothesis testing is made for comparing the expected values of two predictors which are the key drivers for explaing the trend of certain variables that re depeding on the levels of those predicotrs.

Going into more details, making a real-life example, we might need to evaluate the inflence of gender and age on increase of cardiovascular diseases. Under this specification, a question to answer would be: 

to be a female can be more or less risky in incurring on cardiovascualr disease?

or, what is the age on average in which cardiovascular diseases start increasing?

To answer these questions we need to make some assumptions:

- there is no gender difference in cardiovascular diseases
- increasing age is no a cause of cardiovascular diseases

# Hypothesis testing

The first hypothesis is namely, the **null hypothesis** $H_{0}$ and in general, it assumes that there would be no difference in mean (expected value) between the levels of the predictors. In case the null hypothesis fails, an alternative hypothesis is considered, such as there is a difference.

1.  Null hypothesis $H_{0}$: the difference in mean equals to zero
2.  Alternative hypothesis $H_{a}$: the difference in mean is not zero

This is the starting point of making a hypotheis testing, then more variables can be tested, and escluded, or keept whether there is a difference in mean or not. And, so we are talking of multiple testing of hypothesis.


## Steps to hypothesis testing

1.  Define the null and alternatve hypothesis
2.  Construct a test statistic against the null hypothesis
3.  Compute a p-value to quantify the probability to obtain a value which is the same or more extreme of the test statistic under the null hypothesis
4.  Decide whether to reject the null hypothesis


## Step back to modeling

Let's hypothise that we are investigating the root cause of cardiovascular diseases. To be simplicistic we hypothise that only gender and age are the key drivers for high blood pressure, cause of the disease.

How would you make a model for answering this question?

As an example we use the **heart_disease** dataset from the {cheese} package, and to begin our investigation we consider two predictors **Age** and **Sex**.

**Model function**: $y=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{2}\epsilon$

**Hypothesis**:

1.  $\beta_{i}$ equals to zero
2.  there is no difference between the mean blood pressure in female and male groups. 

```{r}
library(cheese)
heart_disease %>%head
```

```{r}
heart_disease%>%
  ggplot(aes(y=HeartDisease,fill=factor(Sex)),color="white") +
  geom_histogram(stat="count",position = "dodge")+
  labs(fill="Sex")+
  scale_fill_brewer()+
  theme_test()
```

To be continued...
</details>

### Resources:

- [HeartDisease](https://cran.r-project.org/web/packages/cheese/vignettes/cheese.html) dataset


